-- MySQL Script generated by MySQL Workbench
-- Sat Jun 23 13:20:53 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema yizhangyichi
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema yizhangyichi
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `yizhangyichi` DEFAULT CHARACTER SET utf8 ;
USE `yizhangyichi` ;

-- -----------------------------------------------------
-- Table `yizhangyichi`.`Todo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `yizhangyichi`.`Todo` (
  `TodoID` BIGINT(100) NOT NULL AUTO_INCREMENT,
  `Content` TEXT NULL,
  `CreatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `UpdatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `Status` INT NOT NULL DEFAULT 0 COMMENT '0: created\n1: finished\n2: snoozed',
  `Type` INT NOT NULL DEFAULT 0 COMMENT '0 normal\n1 timer todo\n2 recur todo',
  `TodoType` VARCHAR(45) NOT NULL DEFAULT 'chi' COMMENT 'zhang\nchi',
  `Note` VARCHAR(1024) NULL,
  PRIMARY KEY (`TodoID`, `TodoType`),
  INDEX `create` (`CreatedTime` ASC),
  INDEX `update` (`UpdatedTime` ASC),
  INDEX `status` (`Status` ASC))
ENGINE = InnoDB PARTITION BY LIST COLUMNS(TodoType) PARTITIONS 2( PARTITION part0 VALUES IN ('zhang'),  PARTITION part1 VALUES IN ('chi')) ;


-- -----------------------------------------------------
-- Table `yizhangyichi`.`Project`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `yizhangyichi`.`Project` (
  `ProjectID` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(100) NULL,
  `CreatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `UpdatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `UserID` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`ProjectID`),
  INDEX `created_time` (`CreatedTime` ASC),
  INDEX `updated_time` (`UpdatedTime` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `yizhangyichi`.`ProjectTodo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `yizhangyichi`.`ProjectTodo` (
  `TodoID` BIGINT(100) NOT NULL,
  `ProjectID` INT NOT NULL,
  `ProjectTodoID` BIGINT(100) NOT NULL AUTO_INCREMENT,
  `CreatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `UpdatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ProjectTodoID`),
  INDEX `ProjectUserIdx` (`TodoID` ASC, `ProjectID` ASC),
  INDEX `UpdatedTimeIdx` (`UpdatedTime` ASC),
  INDEX `CreatedTimeIdx` (`CreatedTime` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `yizhangyichi`.`User`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `yizhangyichi`.`User` (
  `UserID` VARCHAR(100) NOT NULL,
  `FirstName` VARCHAR(45) NULL,
  `Type` VARCHAR(64) NOT NULL DEFAULT 'google' COMMENT 'google\nmicrosoft',
  `Email` VARCHAR(100) NULL,
  `DeviceID` VARCHAR(100) NULL,
  `DeviceType` VARCHAR(100) NULL,
  `PushType` VARCHAR(100) NULL,
  `PushToken` VARCHAR(100) NULL,
  `CreatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `UpdatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `LastName` VARCHAR(45) NULL,
  `Picture` VARCHAR(1000) NULL,
  `Name` VARCHAR(100) NULL,
  PRIMARY KEY (`UserID`),
  INDEX `deviceTypeIdx` (`DeviceType` ASC),
  INDEX `UpdatedTimeIdx` (`UpdatedTime` ASC),
  INDEX `CreatedTimeIdx` (`CreatedTime` ASC),
  INDEX `lastNameIdx` (`LastName` ASC),
  INDEX `firstNameIdx` (`FirstName` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `yizhangyichi`.`UserTodo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `yizhangyichi`.`UserTodo` (
  `UserTodoID` BIGINT(100) NOT NULL AUTO_INCREMENT,
  `UserID` VARCHAR(45) NOT NULL,
  `TodoID` VARCHAR(45) NOT NULL,
  `CreatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `UpdatedTime` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`UserTodoID`),
  INDEX `UserTodoIdx` (`UserID` ASC, `TodoID` ASC),
  INDEX `UpdatedTimeIdx` (`UpdatedTime` ASC),
  INDEX `CreatedTimeIdx` (`CreatedTime` ASC))
ENGINE = InnoDB;

CREATE USER 'cloudsqlproxy' IDENTIFIED BY '7SaeAq8NtQEX';

GRANT SELECT, INSERT, TRIGGER ON TABLE `yizhangyichi`.* TO 'cloudsqlproxy';
GRANT SELECT, INSERT, TRIGGER, UPDATE, DELETE ON TABLE `yizhangyichi`.* TO 'cloudsqlproxy';

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
